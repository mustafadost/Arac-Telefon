<script>
    const SHEET_ID = '1Hz-awgJc2LcniYFymdNpB8rdpBkAUWcZHQ4eaveSfzA';
    // Sona eklenen Date.now() sayesinde tarayıcı her seferinde yeni veri çeker
    const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&tq=select%20A,B,C&cachebuster=${Date.now()}`;

    fetch(url)
        .then(res => res.text())
        .then(text => {
            const json = JSON.parse(text.substring(text.indexOf("{"), text.lastIndexOf("}") + 1));
            const data = json.table.rows[0].c;

            const durum = data[0] ? data[0].v.toString().toUpperCase() : "";
            const telefon = data[1] ? (data[1].f || data[1].v).toString() : "";
            const plaka = data[2] ? data[2].v.toString() : "";

            document.getElementById('loading').style.display = 'none';
            document.getElementById('main-content').style.display = 'block';
            document.getElementById('plaka-display').innerText = plaka;

            if (durum.includes("ACIK")) {
                document.getElementById('badge-area').innerHTML = '<span class="status-badge active">● İLETİŞİME AÇIK</span>';
                document.getElementById('phone-btn').href = "tel:" + telefon;
                document.getElementById('phone-text').innerText = telefon;
                document.getElementById('active-area').style.display = 'block';
            } else {
                document.getElementById('badge-area').innerHTML = '<span class="status-badge passive">● ŞU AN MEŞGUL</span>';
                document.getElementById('passive-area').style.display = 'block';
            }
        })
        .catch(err => {
            document.getElementById('loading').innerText = "BAĞLANTI HATASI!";
        });
</script>
