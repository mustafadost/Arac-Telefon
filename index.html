<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AraÃ§ Ä°letiÅŸim Bilgisi</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Poppins', sans-serif; background: #f3f4f6; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .card { background: white; padding: 30px; border-radius: 25px; box-shadow: 0 15px 35px rgba(0,0,0,0.1); width: 320px; text-align: center; }
        .plaka { font-size: 2.2rem; font-weight: 800; color: #1f2937; margin-bottom: 10px; border-bottom: 3px solid #4f46e5; display: inline-block; }
        .durum { padding: 8px 20px; border-radius: 50px; font-weight: bold; margin: 15px 0; display: inline-block; font-size: 14px; }
        .musait { background: #dcfce7; color: #166534; }
        .mesgul { background: #fee2e2; color: #991b1b; }
        .tel-btn { display: block; background: #4f46e5; color: white; text-decoration: none; padding: 15px; border-radius: 15px; font-weight: bold; font-size: 18px; transition: 0.3s; }
        .tel-btn:hover { background: #4338ca; transform: scale(1.02); }
        .mesaj { color: #6b7280; font-size: 13px; margin-top: 20px; line-height: 1.5; }
        #loader { font-size: 14px; color: #4f46e5; font-weight: bold; }
    </style>
</head>
<body>

<div class="card" id="main-card">
    <div id="loader">ğŸš– AraÃ§ Bilgisi SorgulanÄ±yor...</div>
    <div id="content" class="hidden" style="display:none;">
        <div class="plaka" id="dis-plaka">-- --- --</div>
        <div id="dis-durum" class="durum">YÃœKLENÄ°YOR</div>
        
        <div id="iletisim-alani">
            <a href="#" id="tel-link" class="tel-btn">ğŸ“ SÃ¼rÃ¼cÃ¼yÃ¼ Ara</a>
            <p class="mesaj">LÃ¼tfen aracÄ±n baÅŸÄ±nda deÄŸilseniz sÃ¼rÃ¼cÃ¼yÃ¼ meÅŸgul etmeyiniz.</p>
        </div>
        
        <div id="mesgul-alani" style="display:none;">
            <p class="mesaj" style="color:#ef4444; font-weight:bold;">SÃ¼rÃ¼cÃ¼ ÅŸu anda meÅŸgul olduÄŸunu bildirdi. LÃ¼tfen daha sonra tekrar deneyiniz.</p>
        </div>
    </div>
</div>

<script>
    // 1. Google Web UygulamasÄ± URL'nizi Buraya YapÄ±ÅŸtÄ±rÄ±n!
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyt50JoIVda4N91cVoKQj14Zuwk0zrMbWK_FR_QXc-BbjjWiH-_3O3MQNNwceVZDDwTOw/exec"; 

    function veriyiCek() {
        const urlParams = new URLSearchParams(window.location.search);
        const id = urlParams.get('id');

        if (!id) {
            document.getElementById('loader').innerText = "âŒ Hata: AraÃ§ ID bulunamadÄ±.";
            return;
        }

        // JSONP isteÄŸi oluÅŸturma (CORS engelini aÅŸmak iÃ§in)
        const script = document.createElement('script');
        script.src = `${SCRIPT_URL}?id=${id}&callback=veriyiIsle`;
        document.body.appendChild(script);
    }

    function veriyiIsle(veriler) {
        const urlParams = new URLSearchParams(window.location.search);
        const id = urlParams.get('id');
        const arac = veriler.find(a => a.id == id);

        document.getElementById('loader').style.display = 'none';
        const content = document.getElementById('content');
        content.style.display = 'block';

        if (arac) {
            document.getElementById('dis-plaka').innerText = arac.plaka;
            const durumEl = document.getElementById('dis-durum');
            
            if (arac.durum === "ACIK") {
                durumEl.innerText = "âœ… ÅU AN MÃœSAÄ°T";
                durumEl.className = "durum musait";
                document.getElementById('iletisim-alani').style.display = 'block';
                document.getElementById('mesgul-alani').style.display = 'none';
                document.getElementById('tel-link').href = "tel:" + arac.tel;
            } else {
                durumEl.innerText = "âŒ ÅU AN MEÅGUL";
                durumEl.className = "durum mesgul";
                document.getElementById('iletisim-alani').style.display = 'none';
                document.getElementById('mesgul-alani').style.display = 'block';
            }
        } else {
            document.getElementById('loader').innerText = "âŒ AraÃ§ bulunamadÄ±.";
            document.getElementById('loader').style.display = 'block';
        }
    }

    window.onload = veriyiCek;
</script>

</body>
</html>
